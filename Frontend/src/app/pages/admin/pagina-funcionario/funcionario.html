<div class="funcionario-layout">
  <app-sidebar></app-sidebar>

  <main class="funcionario-content">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1>Painel do Funcionário</h1>
        <p>Solicitações aguardando orçamento</p>
      </div>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="verTodasSolicitacoes()">
          <mat-icon>list</mat-icon>
          Ver todas as solicitações
        </button>
      </div>
    </div>

    <!-- Cards de Estatísticas -->
    <div class="stats-section">
      <div class="stats-grid">
        <app-stat-card
          icon="schedule"
          [number]="estatisticas.abertas"
          label="Abertas"
          variant="warning">
        </app-stat-card>

        <app-stat-card
          icon="monetization_on"
          [number]="estatisticas.orcadas"
          label="Orçadas"
          variant="warning">
        </app-stat-card>

        <app-stat-card
          icon="check_circle"
          [number]="estatisticas.aprovadas"
          label="Aprovadas"
          variant="warning">
        </app-stat-card>

        <app-stat-card
          icon="done_all"
          [number]="estatisticas.finalizadas"
          label="Finalizadas"
          variant="success">
        </app-stat-card>
      </div>
    </div>

    <!-- Seção de Solicitações Abertas -->
    <div class="solicitacoes-section">
      <h2>Solicitações Abertas</h2>
      
      <div class="solicitacoes-list" *ngIf="solicitacoesAbertas.length > 0">
        <app-solicitacao-card
          *ngFor="let solicitacao of solicitacoesAbertas"
          [solicitacao]="solicitacao"
          (verDetalhes)="verDetalhes($event)"
          (efetuarOrcamento)="efetuarOrcamento($event)">
        </app-solicitacao-card>
      </div>

      <div class="empty-state" *ngIf="solicitacoesAbertas.length === 0">
        <mat-icon class="empty-icon">inbox</mat-icon>
        <h3>Não há solicitações em aberto</h3>
        <p>Bom trabalho! Todas as solicitações estão em dia.</p>
      </div>
    </div>

  </main>
</div>

<!-- Modal de Detalhes da Solicitação -->
<app-modal
  *ngIf="modalAberto"
  title="Detalhes da Solicitação"
  submitButtonText="Efetuar Orçamento"
  [isFormValid]="true"
  (close)="fecharModal()"
  (submit)="efetuarOrcamento(solicitacaoSelecionada!)">
  
  <!-- Conteúdo do modal -->
  <ng-template #modalContent>
    <div *ngIf="solicitacaoSelecionada">
      <!-- Informações do Equipamento -->
      <div class="info-section">
        <h3>Equipamento</h3>
        <div class="info-item">
          <mat-icon>build</mat-icon>
          <span>{{ solicitacaoSelecionada.equipamento }}</span>
        </div>
        <div class="info-item">
          <mat-icon>local_offer</mat-icon>
          <span>{{ solicitacaoSelecionada.categoria }}</span>
        </div>
      </div>

      <!-- Informações do Cliente -->
      <div class="info-section">
        <h3>Cliente</h3>
        <div class="info-item">
          <mat-icon>person</mat-icon>
          <span>{{ solicitacaoSelecionada.cliente }}</span>
        </div>
        <div class="info-item">
          <mat-icon>email</mat-icon>
          <span>{{ solicitacaoSelecionada.clienteEmail }}</span>
        </div>
      </div>

      <!-- Descrição do Problema -->
      <div class="info-section">
        <h3>Problema Relatado</h3>
        <div class="problema-descricao">
          <p>{{ solicitacaoSelecionada.descricaoProblema }}</p>
        </div>
      </div>

      <!-- Informações de Data e Status -->
      <div class="info-section">
        <h3>Informações da Solicitação</h3>
        <div class="info-item">
          <mat-icon>schedule</mat-icon>
          <span>Solicitado em: {{ formatarData(solicitacaoSelecionada.dataHora) }}</span>
        </div>
        <div class="info-item">
          <mat-icon>info</mat-icon>
          <span>Status: </span>
          <mat-chip [class]="getStatusClass(solicitacaoSelecionada.status)">
            {{ getStatusText(solicitacaoSelecionada.status) }}
          </mat-chip>
        </div>
      </div>

      <!-- Observações (se houver) -->
      <div class="info-section" *ngIf="solicitacaoSelecionada.observacoes">
        <h3>Observações</h3>
        <div class="problema-descricao">
          <p>{{ solicitacaoSelecionada.observacoes }}</p>
        </div>
      </div>
    </div>
  </ng-template>
</app-modal>