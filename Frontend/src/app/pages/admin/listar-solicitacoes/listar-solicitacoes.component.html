<div class="solicitacoes-layout">
  <app-sidebar></app-sidebar>

  <div class="auth-card">
    <div class="card-header">
      <div>
        <h2>Todas as solicitações</h2>
        <p>Gerencie todas as solicitações de manutenção</p>
      </div>
    </div>

    <div class="card-body">
      <div class="solicitacoes-list" *ngIf="solicitacoes.length > 0">
        <app-solicitacao-card
          *ngFor="let solicitacao of solicitacoes"
          [solicitacao]="solicitacao"
          (verDetalhes)="verDetalhes($event)"
        >
        </app-solicitacao-card>
      </div>

      <div class="empty-state" *ngIf="solicitacoes.length === 0">
        <mat-icon class="empty-icon">inbox</mat-icon>
        <h3>Não há solicitações</h3>
        <p>Nenhuma solicitação foi encontrada no sistema.</p>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Detalhes da Solicitação -->
<div class="modal" *ngIf="modalAberto">
  <div class="modal-content">
    <h2>Detalhes da Solicitação</h2>
    <p>Visualize as informações completas da solicitação</p>

    <div *ngIf="solicitacaoSelecionada" class="solicitacao-details">
      <!-- Equipamento -->
      <div class="detail-item">
        <label>Equipamento:</label>
        <span>{{ solicitacaoSelecionada.product }}</span>
      </div>

      <!-- Categoria -->
      <div class="detail-item">
        <label>Categoria:</label>
        <span>{{ solicitacaoSelecionada.category }}</span>
      </div>

      <!-- Cliente -->
      <div class="detail-item">
        <label>Cliente:</label>
        <span>{{ solicitacaoSelecionada.client }}</span>
      </div>

      <!-- Email do Cliente -->
      <div class="detail-item">
        <label>Email:</label>
        <span>{{ solicitacaoSelecionada.clientEmail }}</span>
      </div>

      <!-- Data/Hora -->
      <div class="detail-item">
        <label>Data/Hora:</label>
        <span>{{ solicitacaoSelecionada.order_date }}</span>
      </div>

      <!-- Status -->
      <app-tag [variant]="solicitacaoSelecionada.situation" />

      <!-- Descrição do Problema -->
      <div class="detail-item full-width">
        <label>Problema Relatado:</label>
        <div class="description-box">
          {{ solicitacaoSelecionada.issue_description }}
        </div>
      </div>

      <!-- Observações (se houver) -->
      <div
        class="detail-item full-width"
        *ngIf="solicitacaoSelecionada.observacoes"
      >
        <label>Observações:</label>
        <div class="description-box">
          {{ solicitacaoSelecionada.observacoes }}
        </div>
      </div>
    </div>

    <!-- Ações -->
    <div class="actions">
      <button mat-button type="button" (click)="fecharModal()">Fechar</button>
      @if (solicitacaoSelecionada?.situation == SituationEnum.ABERTA) {
      <button
        mat-raised-button
        color="primary"
        type="button"
        [routerLink]="['/admin/orcamento', solicitacaoSelecionada!.id]"
      >
        Efetuar Orçamento</button
      >}

      @if (solicitacaoSelecionada?.situation == SituationEnum.APROVADA) {
      <button
        mat-raised-button
        color="success"
        type="button"
        [routerLink]="['/admin/manutencao', solicitacaoSelecionada!.id]"
      >
        Efetuar manutenção</button
      >}

      @if (solicitacaoSelecionada?.situation == SituationEnum.PAGA) {
      <button
        mat-raised-button
        color="success"
        type="button"
        [routerLink]="['/admin/finalizar', solicitacaoSelecionada!.id]"
      >
        Finalizar solicitação</button
      >}
    </div>
  </div>
</div>
