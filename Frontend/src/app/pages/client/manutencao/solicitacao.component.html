<div class="solicitacao-container">
  <div class="solicitacao-layout">
    
    <!-- Header da p√°gina -->
    <div class="page-header">
      <div class="header-content">
        <h1>{{ editandoIndex !== null ? 'Editar Solicita√ß√£o' : 'Nova Solicita√ß√£o' }}</h1>
        <p>{{ editandoIndex !== null ? 'Atualize as informa√ß√µes da solicita√ß√£o' : 'Descreva seu equipamento e o problema encontrado' }}</p>
      </div>
      <div class="header-actions">
        <app-button 
          title="Voltar"
          icon="arrow_back"
          link="/client/home">
        </app-button>
      </div>
    </div>

    <div class="form-container">
      <div class="form-card">
        
        <!-- Progress indicator -->
        <div class="progress-indicator">
          <div class="progress-step active">
            <div class="step-number">1</div>
            <div class="step-label">Equipamento</div>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" [class.active]="novaSolicitacao.descricaoEquipamento">
            <div class="step-number">2</div>
            <div class="step-label">Categoria</div>
          </div>
          <div class="progress-line"></div>
          <div class="progress-step" [class.active]="novaSolicitacao.categoriaEquipamento">
            <div class="step-number">3</div>
            <div class="step-label">Problema</div>
          </div>
        </div>

        <form #formSolicitacao="ngForm" (ngSubmit)="registrarSolicitacao()" class="solicitacao-form">

          <!-- Se√ß√£o do Equipamento -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon>build</mat-icon>
              <h3>Informa√ß√µes do Equipamento</h3>
            </div>
            
            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Descri√ß√£o do equipamento</mat-label>
              <input 
                matInput 
                type="text" 
                name="descricaoEquipamento"
                [(ngModel)]="novaSolicitacao.descricaoEquipamento" 
                maxlength="100"
                required
                placeholder="Ex: Notebook Dell Inspiron 15, TV Samsung 50 polegadas...">
              <mat-hint align="end">{{ novaSolicitacao.descricaoEquipamento.length }}/100</mat-hint>
              <mat-icon matSuffix>build</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Categoria do equipamento</mat-label>
              <mat-select 
                name="categoriaEquipamento" 
                [(ngModel)]="novaSolicitacao.categoriaEquipamento" 
                required>
                <mat-option value="Inform√°tica">
                  <div class="option-content">
                    <mat-icon>computer</mat-icon>
                    <span>Inform√°tica</span>
                  </div>
                </mat-option>
                <mat-option value="Eletr√¥nicos">
                  <div class="option-content">
                    <mat-icon>devices</mat-icon>
                    <span>Eletr√¥nicos</span>
                  </div>
                </mat-option>
                <mat-option value="Eletrodom√©sticos">
                  <div class="option-content">
                    <mat-icon>home</mat-icon>
                    <span>Eletrodom√©sticos</span>
                  </div>
                </mat-option>
                <mat-option value="Outros">
                  <div class="option-content">
                    <mat-icon>more_horiz</mat-icon>
                    <span>Outros</span>
                  </div>
                </mat-option>
              </mat-select>
              <mat-icon matSuffix>category</mat-icon>
            </mat-form-field>
          </div>

          <!-- Se√ß√£o do Problema -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon>report_problem</mat-icon>
              <h3>Descri√ß√£o do Problema</h3>
            </div>

            <mat-form-field appearance="outline" class="w-full">
              <mat-label>Descreva o defeito ou problema</mat-label>
              <textarea 
                matInput 
                rows="5"
                name="descricaoDefeito" 
                [(ngModel)]="novaSolicitacao.descricaoDefeito"
                maxlength="500"
                required
                placeholder="Descreva detalhadamente o problema encontrado no equipamento, incluindo sintomas, quando come√ßou, etc...">
              </textarea>
              <mat-hint align="end">{{ novaSolicitacao.descricaoDefeito.length }}/500</mat-hint>
              <mat-icon matSuffix>report_problem</mat-icon>
            </mat-form-field>

            <!-- Dicas para melhor descri√ß√£o -->
            <div class="form-tips">
              <h4>üí° Dicas para uma melhor descri√ß√£o:</h4>
              <ul>
                <li>Mencione quando o problema come√ßou</li>
                <li>Descreva os sintomas observados</li>
                <li>Informe se h√° mensagens de erro</li>
                <li>Mencione tentativas de solu√ß√£o j√° realizadas</li>
              </ul>
            </div>
          </div>

          <!-- Informa√ß√µes adicionais -->
          <div class="form-section">
            <div class="section-header">
              <mat-icon>info</mat-icon>
              <h3>Informa√ß√µes Adicionais</h3>
            </div>

            <div class="info-cards">
              <div class="info-card">
                <mat-icon>schedule</mat-icon>
                <div>
                  <h4>Data/Hora</h4>
                  <p>{{ formatarDataHora(novaSolicitacao.dataHora) }}</p>
                </div>
              </div>
              
              <div class="info-card">
                <mat-icon>assignment</mat-icon>
                <div>
                  <h4>Status</h4>
                  <p>{{ novaSolicitacao.estado }}</p>
                </div>
              </div>
            </div>
          </div>

          <!-- A√ß√µes do formul√°rio -->
          <div class="form-actions">
            <app-button 
              [title]="editandoIndex !== null ? 'Cancelar Edi√ß√£o' : 'Cancelar'"
              icon="close"
              (clicked)="cancelarSolicitacao()"
              class="cancel-btn">
            </app-button>

            <app-button 
              [title]="editandoIndex !== null ? 'Salvar Altera√ß√µes' : 'Enviar Solicita√ß√£o'"
              [icon]="editandoIndex !== null ? 'save' : 'send'"
              [submit]="true"
              [disabled]="!formSolicitacao.form.valid"
              class="submit-btn">
            </app-button>
          </div>
        </form>
      </div>

      <!-- Sidebar com estat√≠sticas -->
      <div class="form-sidebar">
        <div class="stats-card">
          <h3>Suas Solicita√ß√µes</h3>
          <div class="stats-content">
            <div class="stat-item">
              <span class="stat-number">{{ getTotalSolicitacoes() }}</span>
              <span class="stat-label">Total</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ getSolicitacoesAbertas() }}</span>
              <span class="stat-label">Abertas</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ getSolicitacoesConcluidas() }}</span>
              <span class="stat-label">Conclu√≠das</span>
            </div>
          </div>
        </div>

        <div class="help-card">
          <h3>Precisa de Ajuda?</h3>
          <p>Se voc√™ tiver d√∫vidas sobre como descrever o problema, entre em contato conosco.</p>
          <app-button 
            title="Suporte"
            icon="support"
            class="help-btn">
          </app-button>
        </div>
      </div>
    </div>
  </div>
</div>
